
{% extends 'home_index.html' %}
{% block body %}

<!DOCTYPE html>
<html>
<head>
    <title>Model Evaluation</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body class="bg-light">
<div class="container mt-4">

<h2 class="text-center mb-4">Phishing Detection Model Performance</h2>

<!-- METRICS -->
<div class="row">
    {% for i in metrics%}
    <div class="col-md-3">
        <div class="card shadow p-3">
            <h6>{{ i.name}}</h6>
            <div class="progress">
                <div class="progress-bar bg-success"
                     style="width: {{ i.value }}%">
                    {{ i.value }}%
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<!-- CONFUSION MATRIX -->
<div class="card shadow mt-4 p-3">
<h4>Confusion Matrix</h4>


{{ cm }}

<table class="table table-bordered text-center">
    <tr>
        <th></th>
        <th>Predicted Legit</th>
        <th>Predicted Phishing</th>
    </tr>
    <tr>
        <th>Actual Legit</th>
        <td>{{ cm.0.1 }}</td>
        <td>{{ cm.0.2 }}</td>
    </tr>
    <tr>
        <th>Actual Phishing</th>
        <td>{{ cm.1.1 }}</td>
        <td>{{ cm.1.2 }}</td>
    </tr>
</table>
</div>

<!-- ROC CURVE -->
<div class="card shadow mt-4 p-3">
<h4>ROC Curve (AUC = {{ roc_auc }})</h4>
<canvas id="rocChart"></canvas>
</div>

<!-- CLASSIFICATION REPORT -->
<div class="card shadow mt-4 p-3">
<h4>Classification Report</h4>
<table class="table table-striped">
<tr>
    <th>Class</th>
    <th>Precision</th>
    <th>Recall</th>
    <th>F1-Score</th>
    <th>Support</th>
</tr>
{% for label, values in report.items %}
{% if label != "accuracy" %}
<tr>
    <td>{{ label }}</td>
    <td>{{ values.precision }}</td>
    <td>{{ values.recall }}</td>
    <td>{{ values.f1 }}</td>
    <td>{{ values.support }}</td>
</tr>
{% endif %}
{% endfor %}
</table>
</div>

</div>

<!-- ROC JS -->
<script>
const fpr = {{ fpr|safe }};
const tpr = {{ tpr|safe }};

new Chart(document.getElementById('rocChart'), {
    type: 'line',
    data: {
        labels: fpr,
        datasets: [{
            label: 'ROC Curve',
            data: tpr,
            borderColor: 'blue',
            fill: false
        }]
    },
    options: {
        scales: {
            x: { title: { display: true, text: 'False Positive Rate' }},
            y: { title: { display: true, text: 'True Positive Rate' }}
        }
    }
});
</script>

</body>
</html>


{%endblock%}